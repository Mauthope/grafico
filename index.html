<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráficos de Eficiência e Resíduo</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Estilos para melhorar a aparência */
        .grafico-container {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        canvas {
            width: 400px;
            height: 200px;
        }
        .actions {
            margin-top: 10px;
        }
        .tachado {
            text-decoration: line-through;
        }
    </style>
</head>
<body>
    <h1>Gráficos de Eficiência e Resíduo</h1>

    <div class="grafico-container">
        <canvas id="chart1"></canvas>
        <canvas id="chart2"></canvas>
    </div>

    <div class="grafico-container">
        <canvas id="chart4"></canvas>
        <canvas id="chart5"></canvas>
    </div>

    <div class="actions">
        <h2>Ações</h2>
        <div>
            <button class="acao" id="acao1">Ação 1</button>
            <button class="acao" id="acao2">Ação 2</button>
            <button class="acao" id="acao3">Ação 3</button>
        </div>
    </div>

    <script>
        // Dados de exemplo para os gráficos
        const dados = [
            [
                { data: '2024-01-01', eficiencia: 85, residuo: 12 },
                { data: '2024-01-02', eficiencia: 88, residuo: 10 },
                { data: '2024-01-03', eficiencia: 90, residuo: 8 }
            ],
            [
                { data: '2024-01-01', eficiencia: 82, residuo: 15 },
                { data: '2024-01-02', eficiencia: 84, residuo: 13 },
                { data: '2024-01-03', eficiencia: 89, residuo: 9 }
            ]
        ];

        const acoesTaxadas = JSON.parse(localStorage.getItem('acoesTaxadas')) || [[], [], []]; // Carregar as ações tachadas

        document.addEventListener('DOMContentLoaded', function () {
            // Exibir ações tachadas ao carregar
            acoesTaxadas.forEach((acoes, secao) => {
                acoes.forEach((acionado, index) => {
                    if (acionado) {
                        document.getElementById(`acao${index + 1}`).classList.add('tachado');
                    }
                });
            });

            // Gerar os gráficos
            gerarGrafico(1);
            gerarGrafico(2);
        });

        function gerarGrafico(secao) {
            const ctxEf = document.getElementById(`chart${secao}`).getContext('2d');
            const labels = dados[secao - 1].map(dado => dado.data);
            const eficienciaData = dados[secao - 1].map(dado => dado.eficiencia);
            const residuoData = dados[secao - 1].map(dado => dado.residuo);

            const eficienciaMedia = eficienciaData.reduce((a, b) => a + b, 0) / eficienciaData.length;
            const residuoMedia = residuoData.reduce((a, b) => a + b, 0) / residuoData.length;

            new Chart(ctxEf, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Eficiência',
                            data: eficienciaData,
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Média Eficiência',
                            data: new Array(eficienciaData.length).fill(eficienciaMedia),
                            type: 'line',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            fill: false,
                            borderWidth: 2,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Criar gráfico de resíduos
            const ctxRes = document.getElementById(`chart${secao + 3}`).getContext('2d');
            new Chart(ctxRes, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Resíduo',
                            data: residuoData,
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Média Resíduo',
                            data: new Array(residuoData.length).fill(residuoMedia),
                            type: 'line',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            fill: false,
                            borderWidth: 2,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Marcar uma ação como "tachada" no localStorage
        document.querySelectorAll('.acao').forEach((botao, index) => {
            botao.addEventListener('click', () => {
                const secao = Math.floor(index / 3); // Seções baseadas nos botões
                const acaoIndex = index % 3;
                const acaoButton = document.getElementById(`acao${acaoIndex + 1}`);
                acaoButton.classList.toggle('tachado'); // Alterar a classe tachado

                // Atualizar a ação no localStorage
                acoesTaxadas[secao][acaoIndex] = acaoButton.classList.contains('tachado');
                localStorage.setItem('acoesTaxadas', JSON.stringify(acoesTaxadas));
            });
        });
    </script>
</body>
</html>
